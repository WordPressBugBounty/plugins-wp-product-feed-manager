var _feedHolder;function wppfm_editCategories(){var e=jQuery("#category-selector-lvl");if(wppfm_isCustomChannel(_feedHolder.channel))e.html(wppfm_freeCategoryInputCntrl("default",_feedHolder.feedId,_feedHolder.mainCategory)),e.prop("disabled",!1);else{var t=_feedHolder.mainCategory.split(" > "),r=t.length,n=""!==jQuery("#lvl_"+r).html()?r+1:r;jQuery("#selected-categories").hide(),jQuery("#lvl_0").prop("disabled",!1);for(var a=0;a<n;a++){var p=jQuery("#lvl_"+a);t[a]||p.val("0"),p.show()}}}function wppfm_generateFeed(){""!==jQuery("#wppfm-feed-file-name").val()?(_feedHolder.categoryMapping&&_feedHolder.categoryMapping.length>0||!0===confirm(wppfm_feed_settings_form_vars.no_category_selected))&&(wppfm_disableFeedActionButtons(),wppfm_generateAndSaveFeed()):(jQuery("#alert-message").html("<p>"+wppfm_feed_settings_form_vars.file_name_required+"</p>"),jQuery("#wppfm-success-message").show())}function wppfm_saveFeedData(){""!==jQuery("#wppfm-feed-file-name").val()?wppfm_saveFeed():(jQuery("#alert-message").html("<p>"+wppfm_feed_settings_form_vars.file_name_required+"</p>"),jQuery("#wppfm-success-message").show())}function getCombinedValue(e,t){for(var r=1,n="",a=_feedHolder.getCombinedOutputValue(e,t);jQuery("#combined-input-field-cntrl-"+e+"-"+t+"-"+r).val();){var p=e+"-"+t+"-"+r,i=jQuery("#combined-input-field-cntrl-"+p).val();if(n+=r>1?jQuery("#combined-separator-cntrl-"+p).val()+"#":"","static"!==i)n+="select"!==i?i+"|":"";else{if(!jQuery("#static-input-field-"+p).val()){n=a+"|";break}n+=i+"#"+jQuery("#static-input-field-"+p).val()+"|"}r++}return n=n.substring(0,n.length-1),r>1&&n}function wppfm_staticValueChanged(e,t,r){r>0?wppfm_changedCombinedOutput(e,t,r):(wppfm_setStaticValue(e,t,r),34===e&&wppfm_setIdentifierExistsDependencies())}function wppfm_changedOutputSelection(e){var t=jQuery("#output-field-cntrl-"+e);"no-value"!==t.val()&&wppfm_activateOptionalFieldRow(e,t.val())}function wppfm_hasExtraSourceRow(e,t){return!(!t||!t[e-1])&&t[e-1].hasOwnProperty("c")}function wppfm_changedCustomOutputTitle(){var e=jQuery("#custom-output-title-input").val();e&&wppfm_activateCustomFieldRow(e)}function wppfm_deleteSpecificFeed(e,t){!0===confirm(wppfm_feed_list_form_vars.confirm_delete_feed.replace("%feedname%",t))&&wppfm_deleteFeed(e,t)}function wppfm_valueOptionChanged(e,t,r){var n=wppfm_getCorrectValueSelector(e,t,0,jQuery("#value-options-"+e+"-"+t+"-"+r).val(),"","");jQuery("#value-editor-input-span-"+e+"-"+t+"-"+r).html(n)}function wppfm_getCorrectValueSelector(e,t,r,n,a,p){var i;switch(n){case"0":case"change nothing":case"8":case"strip tags":case"9":case"html entity decode":case"11":case"html entity encode":wppfm_valueInputOptionsChanged(e,t,r),i="";break;case"1":case"overwrite":case"10":case"limit characters":default:i=wppfm_valueOptionsSingleInput(e,t,r,a);break;case"2":case"replace":i=wppfm_valueOptionsReplaceInput(e,t,r,a,p);break;case"3":case"remove":case"4":case"add prefix":case"5":case"add suffix":i=wppfm_valueOptionsSingleInputValue(e,t,r,a);break;case"6":case"recalculate":i=wppfm_valueOptionsRecalculate(e,t,r,a,p);break;case"7":case"convert to child-element":i=wppfm_valueOptionsElementInput(e,t,r,a)}return i}function wppfm_deactivateFeed(e){wppfm_switchFeedStatus(e,function(t){wppfm_updateFeedRowStatus(e,parseInt(t))})}function wppfm_duplicateFeed(e,t){wppfm_showWorkingSpinner(),wppfm_duplicateExistingFeed(e,function(e){e&&(wppfm_showSuccessMessage(wppfm_feed_list_form_vars.added_feed_copy.replace("%feedname%",t)),wppfm_hideWorkingSpinner())})}function wppfm_regenerateFeed(e){var t=wppfmQueueStringIsEmpty()?3:4;wppfmAddToQueueString(e),wppfm_showWorkingSpinner(),wppfm_updateFeedRowStatus(e,t),wppfm_updateFeedFile(e,function(t){if(wppfm_hideWorkingSpinner(),t.includes("channel_not_installed")){var r=t.split(":")[1];return alert(wppfm_feed_list_form_vars.missing_channel.replaceAll("%channelname%",r)),wppfm_updateFeedRowStatus(e,7),void wppfmRemoveFromQueueString(e)}var n=setInterval(function(){wppfm_getCurrentFeedStatus(e,function(t){var r=JSON.parse(t);"3"!==r.status_id&&"4"!==r.status_id&&(wppfm_resetFeedStatus(r),wppfm_resetFeedList(),clearInterval(n),wppfmRemoveFromQueueString(e))})},1e4)})}function wppfm_viewFeed(e){e&&/\/wppfm-feeds\/.*\.xml$/.test(e)?window.open(e):alert(wppfm_feed_list_form_vars.feed_not_generated),wppfm_enableViewFeedButtons()}function wppfm_addRowValueEditor(e,t,r,n){jQuery("#row-"+e).append(wppfm_valueEditor(e,t,r,n)),jQuery("#value-editor-input-query-add-span-"+e+"-"+t+"-"+r).remove()}function wppfm_convertToCamelCase(e){for(var t=e[0].toLowerCase(),r=1;r<e.length;r++)t+=e[r].charAt(0).toUpperCase()+e[r].slice(1);return t}function wppfm_addValueEditorQuery(e,t,r){wppfm_changeValueIsFilled(e,t,r)?wppfm_queryIsFilled(e,t-1,1)?wppfm_showEditValueQuery(e,t,r,!0):alert(wppfm_feed_settings_form_vars.query_requirements):alert(wppfm_feed_settings_form_vars.first_fill_in_change_value)}function wppfm_queryStringToQueryObject(e){var t={};if(e)for(var r in e)t=wppfm_convertQueryStringToQueryObject(e[r]);return t}function wppfm_valueStringToValueObject(e){var t={};if(e)for(var r in e)"q"!==r&&(t=wppfm_convertValueStringToValueObject(e[r]));return t}function wppfm_convertQueryStringToQueryObject(e){var t={},r=e.split("#");return"1"===r[0]||"2"===r[0]?t.preCondition=r[0]:t.preCondition="0",t.source=r[1],t.condition=r[2],t.value=r[3]?r[3]:"",t.endValue=r[5]?r[5]:"",t}function wppfm_resortObject(e){var t=[],r=1;for(var n in e){var a={};for(var p in e[n])"q"!==p?(a[r]=e[n][p],t.push(a)):t[r-1].q=e[n][p];r++}return r>1?t:""}function wppfm_convertValueStringToValueObject(e){var t={},r=e.split("#");return t.preCondition=r[0],t.condition=r[1],t.value=r[2],t.endValue=r[3]?r[3]:"",t}function wppfm_makeCleanQueryObject(){return{preCondition:"if",source:"select",condition:"",value:"",endValue:""}}function wppfm_makeCleanValueObject(){return{preCondition:"change",condition:"overwrite",value:"",endValue:""}}function wppfm_addNewItemToCategoryString(e,t,r,n){var a=t.split(n).length;if(t===wppfm_feed_settings_form_vars.map_to_default_category||"0"===e)return r;if(a<=e)return t+n+r;for(var p=0,i=0;i<e;i++){p=t.indexOf(n,p+1);var o=t.substring(0,p)}return o+n+r}function wppfm_snakeToCamel(e){return e.split("_").map((e,t)=>0===t?e:e.charAt(0).toUpperCase()+e.slice(1)).join("")}