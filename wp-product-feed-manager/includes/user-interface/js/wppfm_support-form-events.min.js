jQuery((function(){jQuery("#wppfm-sign-up-button").on("click",(function(){let email=jQuery("#wppfm-sign-up-mail-input").val();const wpUserName=wppfm_getWpUserNames();email=wppfm_sanitizeEmail(email);if(!email){wppfm_showErrorMessage(wppfm_support_form_vars.email_not_valid);return}wppfm_sendSubscriber(wpUserName,email)}));jQuery(".wppfm-popup__close-button").on("click",(function(){jQuery("#wppfm-channel-info-popup").hide()}));jQuery("#wppfm-accept-eula").on("change",(function(){if(jQuery(this).is(":checked")){jQuery("#wppfm-license-activate").prop("disabled",false)}else{jQuery("#wppfm-license-activate").prop("disabled",true)}}));function wppfm_sendSubscriber(wpUserName,email){const authorizationUsername="listing_manager";const authorizationPassword="rxgbwedYS0XqF1AvkHNPbC06";const base64Auth=btoa(`${authorizationUsername}:${authorizationPassword}`);let params={first_name:wpUserName.firstName,last_name:wpUserName.lastName,email:email,status:"subscribed",tags:[1,11],lists:[6]};jQuery.ajax({method:"POST",url:"https://wpmarketingrobot.com/wp-json/fluent-crm/v2/subscribers/",data:params,headers:{Authorization:"Basic "+base64Auth}}).done((function(){wppfm_showSuccessMessage(wppfm_support_form_vars.chopping_checklist_send)})).fail((function(xhr){wppfm_handleSubscriberError(xhr)}))}function wppfm_handleSubscriberError(xhr){let errorMessage=JSON.parse(xhr.responseText);let emailMessage=errorMessage.hasOwnProperty("email")?errorMessage.email:null;if(emailMessage&&emailMessage.hasOwnProperty("unique")){wppfm_showInfoMessage(wppfm_support_form_vars.email_already_registered)}else{wppfm_showErrorMessage(wppfm_support_form_vars.signup_failed);console.log(errorMessage)}}function wppfm_getWpUserNames(){const dataStorageElement=jQuery("#wppfm-support-page-data-storage");const wpUserName=dataStorageElement.data("wppfmUsername");const firstName=dataStorageElement.data("wppfmUserFistName")||wpUserName;const lastName=dataStorageElement.data("wppfmUserLastName")||wpUserName;return{username:wpUserName,firstName:firstName,lastName:lastName}}}));