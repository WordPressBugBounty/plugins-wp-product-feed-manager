function wppfm_fillFeedList(){var e="",t=jQuery("#wppfm-feed-list");wppfm_getFeedList(function(s){var r=JSON.parse(s).list;e="0"!==r?wppfm_feedListTable(r):wppfm_emptyListTable(),t.empty(),t.append(e)})}function appendCategoryLists(e,t,s){var r=jQuery("#lvl_0"),a=jQuery("#category-selector-lvl");s&&wppfm_getCategoryListsFromString(e,"",t,function(e){var t=JSON.parse(e)[0];t&&t.length>0?(r.html(wppfm_categorySelectCntrl(t)),r.prop("disabled",!1)):(a.html(wppfm_freeCategoryInputCntrl("default","0",!1)),a.prop("disabled",!1))})}function wppfm_resetFeedList(){wppfm_fillFeedList()}function wppfm_resetFeedStatus(e){wppfm_checkNextFeedInQueue(function(){wppfm_updateFeedRowStatus(e.product_feed_id,parseInt(e.status_id)),wppfm_updateFeedRowData(e)})}function wppfm_feedListTable(e){var t="";if(!e)return t;for(var s=0;s<e.length;s++){var r=e[s].status,a=e[s].product_feed_id,p=e[s].url,o="on_hold"===r||"ok"===r,d="",f=wppfm_list_status_text(r);o?d=e[s].products:"processing"===r?d=wppfm_feed_list_form_vars.processing_the_feed:"failed_processing"!==r&&"in_processing_queue"!==r||(d=wppfm_feed_list_form_vars.unknown_text),t+='<tr id="feed-row">',t+='<td id="title-'+a+'">'+e[s].title+"</td>",t+='<td id="url">'+p+"</td>",t+='<td id="updated-'+a+'">'+e[s].updated+"</td>",t+='<td id="products-'+a+'">'+d+"</td>",t+='<td id="type-'+a+'">'+e[s].feed_type_name+"</td>",t+='<td id="feed-status-'+a+'" style="color: '+e[s].color+'"><strong>',t+=f,t+="</strong></td>",t+='<td id="wppfm-feed-list-actions-for-feed-'+a+'">',t+=o?feedReadyActions(a,p,r,e[s].title,e[s].feed_type_name,e[s].feed_type):feedNotReadyActions(a,p,e[s].title,e[s].feed_type),t+="</td>"}return t}function feedReadyActions(e,t,s,r,a,p){var o="No feed generated"!==t,d=t.lastIndexOf("/")>0?t.slice(t.lastIndexOf("/")-t.length+1):r,f=p.replace(/ /g,"-").toLowerCase(),_=r.replace(/ /g,"-").toLowerCase(),i="ok"===s?wppfm_feed_list_form_vars.list_deactivate:wppfm_feed_list_form_vars.list_activate,n='<strong><a href="javascript:void(0);" id="wppfm-edit-'+_+'-action" onclick="parent.location=\'admin.php?page=wppfm-feed-editor-page&feed-type='+f+"&id="+e+"'\">"+wppfm_feed_list_form_vars.list_edit+" </a>";return n+=o?' | <a href="javascript:void(0);" id="wppfm-view-'+_+'-action" onclick="wppfm_viewFeed(\''+t+"')\">"+wppfm_feed_list_form_vars.list_view+"</a>":"",n+=' | <a href="javascript:void(0);" id="wppfm-delete-'+_+'-action" onclick="wppfm_deleteSpecificFeed('+e+", '"+d+"')\">"+wppfm_feed_list_form_vars.list_delete+"</a>",(n+=o?'<a href="javascript:void(0);" id="wppfm-deactivate-'+_+'-action" onclick="wppfm_deactivateFeed('+e+')" id="feed-status-switch-'+e+'"> | '+i+"</a>":"")+wppfmEndOfActionsCode(e,_,a,r,p)}function feedNotReadyActions(e,t,s,r){var a=t.lastIndexOf("/")>0?t.slice(t.lastIndexOf("/")-t.length+1):s,p=s.replace(/ /g,"-").toLowerCase(),o="<strong>";return o+='<a href="javascript:void(0);" id="wppfm-edit-'+p+'-action" onclick="parent.location=\'admin.php?page=wppfm-feed-editor-page&feed-type='+r+"&id="+e+"'\">"+wppfm_feed_list_form_vars.list_edit+"</a>",o+=' | <a href="javascript:void(0);" id="wppfm-delete-'+p+'-action" onclick="wppfm_deleteSpecificFeed('+e+", '"+a+"')\"> "+wppfm_feed_list_form_vars.list_delete+"</a>",(o+=wppfmEndOfActionsCode(e,p,r,s))+wppfm_addFeedStatusChecker(e)}function wppfmEndOfActionsCode(e,t,s,r,a){var p=' | <a href="javascript:void(0);" id="wppfm-duplicate-'+t+'-action" onclick="wppfm_duplicateFeed('+e+", '"+r+"')\">"+wppfm_feed_list_form_vars.list_duplicate+"</a>";return(p+="Product Feed"===a?' | <a href="javascript:void(0);" id="wppfm-regenerate-'+t+'-action" onclick="wppfm_regenerateFeed('+e+')">'+wppfm_feed_list_form_vars.list_regenerate+"</a>":"")+"</strong>"}function wppfm_emptyListTable(){var e="";return e+="<tr>",(e+="<td colspan = 4>"+wppfm_feed_list_form_vars.no_data_found+"</td>")+"</tr>"}function wppfm_updateFeedRowData(e){if("1"===e.status_id||"2"===e.status_id){var t=e.product_feed_id,s="1"===e.status_id?wppfm_feed_list_form_vars.ok:wppfm_feed_list_form_vars.other;jQuery("#updated-"+t).html(e.updated),jQuery("#products-"+t).html(e.products),jQuery("#wppfm-feed-list-actions-for-feed-"+t).html(feedReadyActions(t,e.url,s,e.title,e.feed_type_name,e.feed_type))}}function wppfm_sortOnColumn(e){for(var t=jQuery("tbody#wppfm-feed-list"),s=jQuery("#wppfm-feed-list-page-data-storage"),r=s.data("wppfmSortColumn"),a=s.data("wppfmSortDirection"),p=s.data("wppfmSortableColumns").split("-"),o=0;o<p.length;o++)e.toString()!==p[o]&&wppfm_resetSortableColumns(p[o]);t.find("tr").sort(function(t,p){var o=jQuery("td:nth-child("+e+")",t),d=jQuery("td:nth-child("+e+")",p);return s.data("wppfmSortColumn",e),r!==e||"asc"!==a&&"none"!==a?(s.data("wppfmSortDirection","asc"),o.text().localeCompare(d.text(),!1,{numeric:!0})):(s.data("wppfmSortDirection","desc"),d.text().localeCompare(o.text(),!1,{numeric:!0}))}).appendTo(t),wppfm_setSortedColumn(e),wppfm_redrawAlternateRowBackground()}function wppfm_redrawAlternateRowBackground(){jQuery("tbody#wppfm-feed-list tr:odd").removeClass("alternate"),jQuery("tbody#wppfm-feed-list tr:even").addClass("alternate")}function wppfm_setSortedColumn(e){var t=jQuery("table thead tr th:nth-child("+e+")");t.hasClass("asc")?t.removeClass("asc").addClass("desc"):t.removeClass("desc").addClass("asc"),t.removeClass("sortable").addClass("sorted")}function wppfm_resetSortableColumns(e){var t=jQuery("table thead tr th:nth-child("+e+")");t.removeClass("sorted").addClass("sortable"),t.removeClass("asc").addClass("desc")}function wppfm_switchStatusAction(e,t){var s=jQuery("#title-"+e).html(),r="";switch(s=s.replace(/\s+/g,"-").toLowerCase(),t){case"1":r=" | Auto-off ";break;case"2":r=" | Auto-on "}jQuery("#wppfm-deactivate-"+s+"-action").html(r)}function wppfm_list_status_text(e){switch(e){case"unknown":return wppfm_feed_list_form_vars.unknown;case"ok":return wppfm_feed_list_form_vars.status_ok;case"on_hold":return wppfm_feed_list_form_vars.on_hold;case"processing":return wppfm_feed_list_form_vars.processing;case"in_processing_queue":return wppfm_feed_list_form_vars.processing_queue;case"has_errors":return wppfm_feed_list_form_vars.has_errors;case"failed_processing":return wppfm_feed_list_form_vars.failed_processing}}function wppfm_updateFeedRowStatus(e,t){var s=jQuery("#feed-status-"+e),r=jQuery("#feed-status-switch-"+e),a=jQuery("#products-"+e);switch(t){case 0:s.html("<strong>"+wppfm_feed_list_form_vars.unknown+"</strong>"),s.css("color","#6549F7"),r.html("");break;case 1:s.html("<strong>"+wppfm_feed_list_form_vars.ok+"</strong>"),s.css("color","#0073AA"),r.html(" | "+wppfm_feed_list_form_vars.list_deactivate+" ");break;case 2:s.html("<strong>"+wppfm_feed_list_form_vars.on_hold+"</strong>"),s.css("color","#0173AA"),r.html(" | "+wppfm_feed_list_form_vars.list_activate+" ");break;case 3:s.html("<strong>"+wppfm_feed_list_form_vars.processing+"</strong>"),s.css("color","#0000FF"),r.html(""),a.html(wppfm_feed_list_form_vars.processing_the_feed);break;case 4:s.html("<strong>"+wppfm_feed_list_form_vars.processing_queue+"</strong>"),s.css("color","#00CCFF"),r.html(wppfm_feed_list_form_vars.list_activate+" ");break;case 5:s.html("<strong>"+wppfm_feed_list_form_vars.has_errors+"</strong>"),s.css("color","#FF0000"),a.html(wppfm_feed_list_form_vars.unknown_text),r.html(wppfm_feed_list_form_vars.list_activate+" ");break;case 6:s.html("<strong>"+wppfm_feed_list_form_vars.processing_failed+"</strong>"),s.css("color","#FF3300"),a.html(wppfm_feed_list_form_vars.unknown_text),r.html("");break;case 7:s.html("<strong>"+wppfm_feed_list_form_vars.no_channel+"</strong>"),s.css("color","#FF3300"),a.html(wppfm_feed_list_form_vars.unknown_text),r.html("")}}jQuery(function(){});